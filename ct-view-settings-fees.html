<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-input/paper-input.html">

<link rel="import" href="../ct-currency-behaviour/ct-currency-behaviour.html">
<link rel="import" href="../ct-editable-switcher/ct-editable-switcher.html">
<link rel="import" href="../shared-styles/ct-application-theme.html">

<!--
`ct-view-settings-fees`
Element to view fees in settings on the Centular platform

@demo demo/index.html
-->

<dom-module id="ct-view-settings-fees">

  <template>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <style is="global-styles">
      :host {
        display: block;
        --paper-input-container:{
          padding: 0 !important;
        };
        paper-input-container:{
          padding: 0 !important;
        };
      }
      .vertical-middle {
        vertical-align: middle;
        display: table-cell;
      }
      .vertical-middle-container {
        height: 62px;
        display: table;
        float: none;
        table-layout: fixed;
      }

      .row-striped:nth-of-type(odd){
        background-color: #efefef;
      }

      .row-striped:nth-of-type(even){
        background-color: #ffffff;
      }
      .fees-container .row {
        /*display: flex;*/
        align-items: center;
      }
      paper-input-container.input-element {
        padding: 0 !important;
      }
    </style>

    <div class="container-fluid fees-container">

      <div class="row">
        <div class="col-sm-2 col-sm-offset-10">
          <paper-button
                  class$="btn btn-block [[_computeBtnStyle(_isStateEdit)]]"
                  on-tap="_editBtnHandler"
                  raised>
            [[_computeButtonText(_isStateEdit)]]
          </paper-button>
        </div>

      </div>
      <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-9">


      <div class="row">

        <div class="col-xs-12 col-sm-12 col-md-12">
          <div><h4>Admin Fees (inc VAT)</h4></div>
        </div>
        <div class="col-sm-offset-4 col-xs-3 col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
            <paper-input
                    class="input-element"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[formatMoney(_dataObj.adminFees.currencyValue)]]">
              <div prefix>R </div>
            </paper-input>
          </ct-editable-switcher>
        </div>
        <div class="col-xs-1 col-sm-1 col-md-1">
          <div class="text-center vertical-middle-container"><span class="vertical-middle">+</span></div>
        </div>
        <div class="col-xs-5 col-sm-3 col-md-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]" class="text-right">
            <paper-input
                    class="input-element"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[_dataObj.adminFees.percentageValue]]">
              <div suffix>%</div>
            </paper-input>
          </ct-editable-switcher>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-12">
          <div><h4>Merchant Fees (inc VAT)</h4></div>
        </div>
      </div>

      <div class="row row-striped">
        <div class="col-sm-4">
          <div class="vertical-middle-container"><span class="vertical-middle">Speedpay</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
            <paper-input
                    class="input-element"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[formatMoney(_dataObj.speedPay.currencyValue)]]">
              <div prefix>R </div>
            </paper-input>
          </ct-editable-switcher>
        </div>
        <div class="col-sm-1">
          <div class="text-center vertical-middle-container"><span class="vertical-middle">+</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]" class="text-right">
            <paper-input
                    class="input-element"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[_dataObj.speedPay.percentageValue]]">
              <div suffix>%</div>
            </paper-input>
          </ct-editable-switcher>
        </div>
      </div>

      <div class="row row-striped">
        <div class="col-sm-4">
          <div class="vertical-middle-container"><span class="vertical-middle">Credit Card</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
            <paper-input
                    class="input-element"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[formatMoney(_dataObj.creditCard.currencyValue)]]">
              <div prefix>R </div>
            </paper-input>
          </ct-editable-switcher>
        </div>
        <div class="col-sm-1">
          <div class="text-center vertical-middle-container"><span class="vertical-middle">+</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]" class="text-right">
            <paper-input
                    class="input-element"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[_dataObj.creditCard.percentageValue]]">
              <div suffix>%</div>
            </paper-input>
          </ct-editable-switcher>
        </div>
      </div>

      <div class="row row-striped">
        <div class="col-sm-4">
          <div class="vertical-middle-container"><span class="vertical-middle">EFT</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
            <paper-input
                    class="input-element"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[formatMoney(_dataObj.eft.currencyValue)]]">
              <div prefix>R </div>
            </paper-input>
          </ct-editable-switcher>
        </div>
        <div class="col-sm-1">
          <div class="text-center vertical-middle-container"><span class="vertical-middle">+</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]" class="text-right">
            <paper-input
                    class="input-element"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[_dataObj.eft.percentageValue]]">
              <div suffix>%</div>
            </paper-input>
          </ct-editable-switcher>
        </div>
      </div>

      <div class="row row-striped">
        <div class="col-sm-4">
          <div class="vertical-middle-container"><span class="vertical-middle">PayFast</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
            <paper-input
                    class="input-element"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[formatMoney(_dataObj.payFast.currencyValue)]]">
              <div prefix>R </div>
            </paper-input>
          </ct-editable-switcher>
        </div>
        <div class="col-sm-1">
          <div class="text-center vertical-middle-container"><span class="vertical-middle">+</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]" class="text-right">
            <paper-input
                      class="input-element vertical-middle-container"
                      type="text"
                      allowed-pattern="[0-9\.]"
                      no-label
                      value="[[_dataObj.payFast.percentageValue]]">
                <div suffix>%</div>
            </paper-input>
          </ct-editable-switcher>
        </div>
      </div>

      <div class="row row-striped">
        <div class="col-sm-4">
          <div class="vertical-middle-container"><span class="vertical-middle">Self Vend</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
            <paper-input
                    class="input-element vertical-middle"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[formatMoney(_dataObj.selfVend.currencyValue)]]">
              <div prefix>R </div>
            </paper-input>
          </ct-editable-switcher>
        </div>
        <div class="col-sm-1">
          <div class="text-center vertical-middle-container"><span class="vertical-middle">+</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]" class="text-right">
            <paper-input
                    class="input-element vertical-middle"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[_dataObj.selfVend.percentageValue]]">
              <div suffix>%</div>
            </paper-input>
          </ct-editable-switcher>
        </div>
      </div>

      <div class="row row-striped">
        <div class="col-sm-4">
          <div class="vertical-middle-container"><span class="vertical-middle">Free Issue</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
            <div class="vertical-middle-container">
              <paper-input
                    class="input-element vertical-middle"
                    type="text"
                    allowed-pattern="[0-9\.]"
                    no-label
                    value="[[formatMoney(_dataObj.freeIssue.currencyValue)]]">
              <div prefix>R </div>
            </paper-input>
              </div>
          </ct-editable-switcher>
        </div>
        <div class="col-sm-1">
          <div class="text-center vertical-middle-container"><span class="vertical-middle">+</span></div>
        </div>
        <div class="col-sm-3">
          <ct-editable-switcher edit-mode$="[[_isStateEdit]]" class="text-right">
            <div class="vertical-middle-container">
              <paper-input
                      class="input-element vertical-middle"
                      type="text"
                      allowed-pattern="[0-9\.]"
                      no-label
                      value="[[_dataObj.freeIssue.percentageValue]]">
                <div suffix>%</div>
              </paper-input>
          </div>
          </ct-editable-switcher>
        </div>
      </div>
    </div>
  </div>
    </div>

  </template>

  <script>
      Polymer({

          is: 'ct-view-settings-fees',
          behaviors: [CurrencyBehaviours.CurrencyFormatBehaviour],

          properties: {
              _isStateEdit : {
                  type: Boolean,
                  value: function() {
                      return false;
                  },
              },

              _dataObj: {
                  type: Object,
                  value: function() {
                      return {
                          adminFees: {
                              currencyValue: 10,
                              percentageValue: 20
                          },
                          speedPay: {
                              currencyValue: 10,
                              percentageValue: 20
                          },
                          creditCard: {
                              currencyValue: 10,
                              percentageValue: 20
                          },
                          eft: {
                              currencyValue: 10,
                              percentageValue: 20
                          },
                          payFast: {
                              currencyValue: 10,
                              percentageValue: 20
                          },
                          selfVend: {
                              currencyValue: 10,
                              percentageValue: 20
                          },
                          freeIssue: {
                              currencyValue: 10,
                              percentageValue: 20
                          },

                      }
                  }
              }
          },

          _computeReadOnly : function(status){
              return (!status);
          },

          _computeButtonText: function(isEdit){
              return (isEdit) ? 'Save Fees' : 'Edit Fees';
          },

          _computeBtnStyle : function(isEdit){
              return (isEdit) ? "btn-primary" : "btn-default";
          },

          _toggleStatus : function(){
              this._isStateEdit = !this._isStateEdit;
          },

          _editBtnHandler : function(){
//            todo: event fired on edit/save
//            todo: event to emit notification

              this._toggleStatus();
          },

      });
  </script>
</dom-module>
